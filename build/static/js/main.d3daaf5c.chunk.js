(this["webpackJsonpsocket-chat"]=this["webpackJsonpsocket-chat"]||[]).push([[0],{102:function(e,t,a){},103:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(44),o=a.n(c),s=(a(52),a(19)),l=a.n(s),u=a(45),m=a(3),i=(a(54),a(10)),E=a(2),d=a(11),p=a.n(d),b=function(e){var t=e.onLogin,a=Object(n.useState)({roomId:"",userName:""}),c=Object(m.a)(a,2),o=c[0],s=c[1],l=Object(n.useState)(!1),u=Object(m.a)(l,2),d=u[0],b=u[1],f=o.roomId,S=o.userName,O=function(e){var t=e.target,a=t.name,n=t.value;s((function(e){return Object(E.a)(Object(E.a)({},e),{},Object(i.a)({},a,n))}))},N=Object(n.useCallback)((function(){if(f&&S){b(!0);var e={roomId:f,userName:S};p.a.post("/rooms",e).then((function(){t(e)}))}else console.warn("Data not entered!!!")}),[t,f,S]);return r.a.createElement("div",{className:"block"},r.a.createElement("input",{name:"roomId",type:"text",placeholder:"Room ID",value:f,onChange:O}),r.a.createElement("input",{name:"userName",type:"text",placeholder:"YOUR NAME",value:S,onChange:O}),r.a.createElement("button",{disabled:d,className:"btn-input",onClick:N},d?"\u0412\u0425\u041e\u0414...":"\u0412\u041e\u0419\u0422\u0418"))},f=a(46),S=a.n(f)()(),O=function(e,t){switch(t.type){case"JOINED":var a=t.payload,n=a.roomId,r=a.userName;return Object(E.a)(Object(E.a)({},e),{},{joined:!0,roomId:n,userName:r});case"SET_USERS":return Object(E.a)(Object(E.a)({},e),{},{users:t.payload});case"SET_MESSAGES":return Object(E.a)(Object(E.a)({},e),{},{messages:t.payload});case"SET_CURRENT_USER":return Object(E.a)(Object(E.a)({},e),{},{currentUser:t.payload});default:return e}},N=(a(102),function(e){var t=e.users,a=e.messages,c=e.userName,o=e.roomId,s=Object(n.useRef)(null),l=Object(n.useState)(""),u=Object(m.a)(l,2),i=u[0],E=u[1];Object(n.useEffect)((function(){s&&s.current&&s.current.scrollTo(0,s.current.scrollHeight)}),[a]);return r.a.createElement("div",{className:"wrapper"},r.a.createElement("div",{className:"chat-users"},r.a.createElement("b",null,"\u041a\u041e\u041c\u041d\u0410\u0422\u0410 ".concat(o)),r.a.createElement("hr",null),r.a.createElement("b",null,"\u041e\u043d\u043b\u0430\u0439\u043d (".concat(t.length,"):")),r.a.createElement("ul",null,t.map((function(e,t){return r.a.createElement("li",{key:t,style:{color:e===c?"tomato":"blue"}},e)})))),r.a.createElement("div",{className:"chat-messages"},r.a.createElement("div",{className:"messages",ref:s},a.map((function(e,t){return r.a.createElement("div",{className:"message",style:{alignSelf:e.userName===c?"flex-start":"flex-end"},key:t+e.userName},r.a.createElement("p",{style:{backgroundColor:e.userName===c?"tomato":"blue"}},e.text),r.a.createElement("div",null,r.a.createElement("small",{style:{color:e.userName===c?"tomato":"blue"}},e.userName)))}))),r.a.createElement("form",{onSubmit:function(e){if(e.preventDefault(),i){var t={text:i,roomId:o,userName:c};S.emit("ROOM:SEND_MESSAGE",t),E("")}}},r.a.createElement("textarea",{name:"text",rows:"3",value:i,placeholder:"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0441\u0432\u043e\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",onChange:function(e){var t=e.target.value;E(t)}}),r.a.createElement("button",{type:"submit",disabled:!i},"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"))))});var j=function(){var e=Object(n.useReducer)(O,{joined:!1,roomId:null,userName:null,users:[],messages:[]}),t=Object(m.a)(e,2),a=t[0],c=t[1],o=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n,r,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c({type:"JOINED",payload:t}),S.emit("ROOM:JOIN",t),e.next=4,d.get("/rooms/".concat(t.roomId));case 4:a=e.sent,n=a.data,r=n.users,o=n.messages,c({type:"SET_USERS",payload:r}),c({type:"SET_MESSAGES",payload:o});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(e){c({type:"SET_USERS",payload:e})};return Object(n.useEffect)((function(){S.on("ROOM:SET_USERS",s),S.on("ROOM:SET_MESSAGES",(function(e){return c({type:"SET_MESSAGES",payload:e})}))}),[]),r.a.createElement("div",{className:"wrapper"},a.joined?r.a.createElement(N,a):r.a.createElement(b,{onLogin:o}))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(j,null)),document.getElementById("root"))},47:function(e,t,a){e.exports=a(103)},52:function(e,t,a){},54:function(e,t,a){},99:function(e,t){}},[[47,1,2]]]);
//# sourceMappingURL=main.d3daaf5c.chunk.js.map